cmake_minimum_required(VERSION 3.7)

include(FindPkgConfig)

set(TARGET_NAME demo)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_INCLUDE_CURRENT_DIR ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_AUTOUIC ON)

file(GLOB_RECURSE SOURCES "*.cpp")
file(GLOB_RECURSE HEADERS "*.h")
file(GLOB_RECURSE FORMS "*.ui")
file(GLOB_RECURSE RESOURCES "*.qrc")

find_package(PkgConfig REQUIRED)

set(QT Core Gui Widgets Network DBus Sql)

find_package(Qt5 REQUIRED ${QT})

pkg_check_modules(3rd_lib REQUIRED
        dtkwidget dframeworkdbus
)

add_executable(${TARGET_NAME} ${SOURCES} ${HEADERS} ${FORMS} ${RESOURCES})

target_include_directories(${TARGET_NAME} PUBLIC ${3rd_lib_INCLUDE_DIRS} )
target_link_libraries(${TARGET_NAME} ${3rd_lib_LIBRARIES} )

qt5_use_modules(${TARGET_NAME} ${QT})

set(CMAKE_INSTALL_PREFIX /usr)

install(TARGETS ${TARGET_NAME} DESTINATION bin)
